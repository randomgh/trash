{"version":3,"sources":["blocks/media-editor.js"],"names":["wp","location","registerBlockType","blocks","_wp$i18n","i18n","__","_wp$editor","setLocaleData","editor","BlockControls","MediaUpload","InspectorControls","_wp$components","components","Toolbar","Modal","BaseControl","IconButton","Button","TextControl","element","Fragment","title","icon","category","supports","htmlValidation","default","youtube","type","openedVimeo","openedIFrame","onSelectVideo","setAttributes","openedYT","content","onCloseIFrame","props","ID","concat","Math","round","random","className","createElement","onSelect","media","_toConsumableArray","attributes","map","data","allowedTypes","multiple","render","_ref","open","label","onClick","_ref2","onSelectYT","item","onSelectIFrame","iframe","href","data-fancybox","data-src","onChangeIFrame","value","onChange","isDefault","onOpenYT","onCloseYT","onRequestClose","onCloseVimeo","vimeo","save","url","data-caption","caption","src","alt","frameBorder","onOpenVimeo","origin","onOpenIFrame","window"],"mappings":"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","file":"media-editor.js","sourcesContent":["((wp, location) => {\r\n    const { registerBlockType } = wp.blocks,\r\n          { __, setLocaleData } = wp.i18n,\r\n          { BlockControls, InspectorControls, MediaUpload } = wp.editor,\r\n          { Toolbar, BaseControl, Modal, IconButton, Button, TextControl } = wp.components,\r\n          { Fragment } = wp.element;\r\n\r\n    registerBlockType('zabit/media', {\r\n        title: __('Media', 'zabit'),\r\n        icon: 'images-alt',\r\n        category: 'layout',\r\n\r\n        supports: {\r\n            htmlValidation: false\r\n        },\r\n\r\n        attributes: {\r\n            content: {\r\n                type: 'array',\r\n                default: []\r\n            },\r\n\r\n            youtube: {\r\n                type: 'string',\r\n                default: ''\r\n            },\r\n\r\n            vimeo: {\r\n                type: 'string',\r\n                default: ''\r\n            },\r\n\r\n            iframe: {\r\n                type: 'string',\r\n                default: ''\r\n            },\r\n\r\n            openedYT: {\r\n                type: 'boolean',\r\n                default: false\r\n            },\r\n\r\n            openedVimeo: {\r\n                type: 'boolean',\r\n                default: false\r\n            },\r\n\r\n            openedIFrame: {\r\n                type: 'boolean',\r\n                default: false\r\n            }\r\n        },\r\n\r\n        edit: props => {\r\n            const ID = `zabit/media:${Math.round(Math.random() * 1024 * 1024)}`;\r\n\r\n            const onSelectImages = media => {\r\n                props.setAttributes({ content: [...props.attributes.content, ...media.map(data => {\r\n                        return {\r\n                            type: 'image',\r\n                            data\r\n                        };\r\n                    })] });\r\n            };\r\n\r\n            const onSelectVideo = media => {\r\n                props.setAttributes({ content: [...props.attributes.content, ...media.map(data => {\r\n                        return {\r\n                            type: 'video',\r\n                            data\r\n                        };\r\n                    })] });\r\n            };\r\n\r\n            const onOpenYT = () => {\r\n                props.setAttributes({ openedYT: true });\r\n            };\r\n\r\n            const onCloseYT = () => {\r\n                props.setAttributes({ openedYT: false });\r\n            };\r\n\r\n            const onSelectYT = () => {\r\n                if (props.attributes.youtube !== '') {\r\n                    props.setAttributes({\r\n                        content: [...props.attributes.content, {\r\n                            type: 'youtube',\r\n                            data: props.attributes.youtube\r\n                        }],\r\n                        youtube: ''\r\n                    });\r\n\r\n                    onCloseYT();\r\n                }\r\n            };\r\n\r\n            const onChangeYT = youtube => {\r\n                props.setAttributes({ youtube });\r\n            };\r\n\r\n            const onOpenVimeo = () => {\r\n                props.setAttributes({ openedVimeo: true });\r\n            };\r\n\r\n            const onCloseVimeo = () => {\r\n                props.setAttributes({ openedVimeo: false });\r\n            };\r\n\r\n            const onSelectVimeo = () => {\r\n                if (props.attributes.vimeo !== '') {\r\n                    props.setAttributes({\r\n                        content: [...props.attributes.content, {\r\n                            type: 'vimeo',\r\n                            data: props.attributes.vimeo\r\n                        }],\r\n                        vimeo: ''\r\n                    });\r\n\r\n                    onCloseVimeo();\r\n                }\r\n            };\r\n\r\n            const onChangeVimeo = vimeo => {\r\n                props.setAttributes({ vimeo });\r\n            };\r\n\r\n            const onOpenIFrame = () => {\r\n                props.setAttributes({ openedIFrame: true });\r\n            };\r\n\r\n            const onCloseIFrame = () => {\r\n                props.setAttributes({ openedIFrame: false });\r\n            };\r\n\r\n            const onSelectIFrame = () => {\r\n                if (props.attributes.iframe !== '') {\r\n                    props.setAttributes({\r\n                        content: [...props.attributes.content, {\r\n                            type: 'iframe',\r\n                            data: props.attributes.iframe\r\n                        }],\r\n                        iframe: ''\r\n                    });\r\n\r\n                    onCloseIFrame();\r\n                }\r\n            };\r\n\r\n            const onChangeIFrame = iframe => {\r\n                props.setAttributes({ iframe });\r\n            };\r\n\r\n            return <div className={`${props.className} media`}>\r\n                <BlockControls>\r\n                    <Toolbar>\r\n                        <MediaUpload onSelect={onSelectImages} allowedTypes={['image/jpeg', 'image/jpg', 'image/png']} multiple={true} render={({ open }) => <IconButton icon=\"plus\" label={__('Upload', 'zabit')} onClick={open} />}/>\r\n                        <MediaUpload onSelect={onSelectVideo} allowedTypes={['video']} multiple={true} render={({ open }) => <IconButton icon=\"plus\" label={__('Upload', 'zabit')} onClick={open} />}/>\r\n                        <IconButton icon=\"format-video\" label=\"Add\" onClick={onOpenYT} />\r\n                        <IconButton icon=\"format-video\" label=\"Add\" onClick={onOpenVimeo} />\r\n                        <IconButton icon=\"format-video\" label=\"Add\" onClick={onOpenIFrame} />\r\n                    </Toolbar>\r\n                </BlockControls>\r\n                {props.attributes.content.map(item => <div className=\"media__item\">\r\n                    {(item => {\r\n                        switch (item.type) {\r\n                            case 'image':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={item.data.url} data-fancybox={ID} data-caption={item.data.caption}>{item.data.id}</a>;\r\n                            case 'video':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={item.data.url} data-fancybox={ID} data-caption={item.data.caption}>{item.data.id}</a>;\r\n                            case 'vimeo':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={`https://vimeo.com/${item.data}`} data-fancybox={ID}>{item.data}</a>;\r\n                            case 'youtube':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={`https://www.youtube.com/watch?v=${item.data}`} data-fancybox={ID}>{item.data}</a>;\r\n                            case 'iframe':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={item.data} data-fancybox={ID} data-src={item.data}>{item.data}</a>;\r\n                        }\r\n                    })(item)}\r\n                </div>)}\r\n                {props.attributes.openedYT && <Modal title={__('Youtube', 'zabit')} onRequestClose={onCloseYT}>\r\n                    <TextControl label={__('Youtube ID', 'zabit')} value={props.attributes.youtube} onChange={onChangeYT} />\r\n                    <Button isDefault onClick={onSelectYT}>{__('Add', 'zabit')}</Button>\r\n                </Modal>}\r\n                {props.attributes.openedVimeo && <Modal title={__('Vimeo', 'zabit')} onRequestClose={onCloseVimeo}>\r\n                    <TextControl label={__('Vimeo ID', 'zabit')} value={props.attributes.vimeo} onChange={onChangeVimeo} />\r\n                    <Button isDefault onClick={onSelectVimeo}>{__('Add', 'zabit')}</Button>\r\n                </Modal>}\r\n                {props.attributes.openedIFrame && <Modal title={__('IFrame', 'zabit')} onRequestClose={onCloseIFrame}>\r\n                    <TextControl label={__('IFrame URL', 'zabit')} value={props.attributes.iframe} onChange={onChangeIFrame} />\r\n                    <Button isDefault onClick={onSelectIFrame}>{__('Add', 'zabit')}</Button>\r\n                </Modal>}\r\n            </div>;\r\n        },\r\n\r\n        save: props => {\r\n            const ID = `zabit/media:${Math.round(Math.random() * 1024 * 1024)}`;\r\n\r\n            return <div className={`${props.className} media`}>\r\n                {props.attributes.content.map(item => <div className=\"media__item\">\r\n                    {(item => {\r\n                        switch (item.type) {\r\n                            case 'image':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={item.data.url} data-fancybox={ID} data-caption={item.data.caption}>\r\n                                    <img src={item.data.url} title={item.data.title} alt={item.data.alt} />\r\n                                </a>;\r\n                            case 'video':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={item.data.url} data-fancybox={ID} data-caption={item.data.caption}>\r\n                                    <video>\r\n                                        <source src={item.data.url} type=\"video/mp4\" />\r\n                                        {__(\"Your browser doesn't support HTML5 video tag.\", 'zabit')}\r\n                                    </video>\r\n                                </a>;\r\n                            case 'vimeo':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={`https://vimeo.com/${item.data}`} data-src={`https://vimeo.com/${item.data}`} data-fancybox={ID}>\r\n                                    <iframe src={`http://player.vimeo.com/video/${item.data}`} frameBorder=\"0\" />\r\n                                </a>;\r\n                            case 'youtube':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={`https://www.youtube.com/watch?v=${item.data}`} data-src={`https://www.youtube.com/watch?v=${item.data}`} data-fancybox={ID}>\r\n                                    <iframe src={`http://www.youtube.com/embed/${item.data}?autoplay=0&controls=0&origin=${location.origin}`} frameBorder=\"0\" />\r\n                                </a>;\r\n                            case 'iframe':\r\n                                return <a className={`media__item__content media__item__content_${item.type}`} href={item.data} data-fancybox={ID} data-src={item.data}>\r\n                                    <iframe src={item.data} frameBorder=\"0\" />\r\n                                </a>;\r\n                        }\r\n                    })(item)}\r\n                </div>)}\r\n            </div>;\r\n        }\r\n    });\r\n})(window.wp, location);\r\n"]}